{"ast":null,"code":"import { ElementRef, EventEmitter } from '@angular/core';\nimport * as ClassicEditorBuild from '../../../vendor/ckeditor5/build/classic-editor-with-track-changes.js';\nimport { getLoadSaveIntegration } from './load-save-integration';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ckeditor/ckeditor5-angular\";\nconst _c0 = [\"sidebar\"];\nexport let LoadSaveIntegrationComponent = /*#__PURE__*/(() => {\n  class LoadSaveIntegrationComponent {\n    constructor() {\n      this.ready = new EventEmitter();\n      this.Editor = ClassicEditorBuild.ClassicEditorWithTrackChanges;\n      this.data = this.getInitialData();\n      this.STORAGE_KEY = 'ckeditor-license-key';\n      this.licenseKey = '';\n      // Application data will be available under a global variable `appData`.\n      this.appData = {\n        // The ID of the current user.\n        userId: 'user-1',\n        // Users data.\n        users: [{\n          id: 'user-1',\n          name: 'Joe Doe',\n          // Note that the avatar is optional.\n          avatar: 'https://randomuser.me/api/portraits/thumb/men/26.jpg'\n        }, {\n          id: 'user-2',\n          name: 'Ella Harper',\n          avatar: 'https://randomuser.me/api/portraits/thumb/women/65.jpg'\n        }],\n        // Suggestion threads data.\n        suggestions: [{\n          id: 'suggestion-1',\n          type: 'insertion',\n          authorId: 'user-2',\n          createdAt: new Date(2019, 1, 13, 11, 20, 48)\n        }, {\n          id: 'suggestion-2',\n          type: 'deletion',\n          authorId: 'user-1',\n          createdAt: new Date(2019, 1, 14, 12, 7, 20)\n        }, {\n          id: 'suggestion-3',\n          type: 'insertion',\n          authorId: 'user-1',\n          createdAt: new Date(2019, 1, 14, 12, 7, 20)\n        }, {\n          id: 'suggestion-4',\n          type: 'deletion',\n          authorId: 'user-1',\n          createdAt: new Date(2019, 1, 15, 8, 44, 1)\n        }, {\n          id: 'suggestion-5',\n          type: 'formatInline:886cqig6g8rf',\n          authorId: 'user-2',\n          createdAt: new Date(2019, 2, 8, 10, 2, 7),\n          data: {\n            commandName: 'bold',\n            commandParams: [{\n              forceValue: true\n            }]\n          }\n        }, {\n          id: 'suggestion-6',\n          type: 'formatBlock:698dn3otqzd6',\n          authorId: 'user-2',\n          createdAt: new Date(2019, 2, 8, 10, 2, 10),\n          data: {\n            commandName: 'heading',\n            commandParams: [{\n              value: 'heading2'\n            }],\n            formatGroupId: 'blockName',\n            multipleBlocks: false\n          }\n        }],\n        // Comment threads data.\n        commentThreads: [{\n          threadId: 'suggestion-1',\n          comments: [{\n            commentId: 'comment-1',\n            authorId: 'user-1',\n            content: '<p>Are you sure it will fit here?</p>',\n            createdAt: new Date('09/20/2018 14:21:53')\n          }, {\n            commentId: 'comment-2',\n            authorId: 'user-2',\n            content: '<p>I think so...</p>',\n            createdAt: new Date('09/21/2018 08:17:01')\n          }]\n        }]\n      };\n      // Note that Angular refs can be used once the view is initialized so we need to create\n      // this container and use in the above editor configuration to work around this problem.\n      this.sidebar = document.createElement('div');\n      this.boundRefreshDisplayMode = this.refreshDisplayMode.bind(this);\n      this.boundCheckPendingActions = this.checkPendingActions.bind(this);\n    }\n    get editorConfig() {\n      return {\n        extraPlugins: [getLoadSaveIntegration(this.appData)],\n        sidebar: {\n          container: this.sidebar\n        },\n        licenseKey: this.licenseKey\n      };\n    }\n    ngOnInit() {\n      window.CKBox = ClassicEditorBuild.CKBox;\n      // Save the provided license key in the local storage.\n      this.licenseKey = window.localStorage.getItem(this.STORAGE_KEY) || window.prompt('Your license key');\n      window.localStorage.setItem(this.STORAGE_KEY, this.licenseKey);\n    }\n    ngAfterViewInit() {\n      if (!this.sidebarContainer) {\n        throw new Error('Div container for sidebar was not found');\n      }\n      this.sidebarContainer.nativeElement.appendChild(this.sidebar);\n    }\n    ngOnDestroy() {\n      window.removeEventListener('resize', this.boundRefreshDisplayMode);\n      window.removeEventListener('beforeunload', this.boundCheckPendingActions);\n    }\n    onReady(editor) {\n      this.editor = editor;\n      this.ready.emit(editor);\n      // Make the track changes mode the \"default\" state by turning it on right after the editor initializes.\n      this.editor.execute('trackChanges');\n      // Prevent closing the tab when any action is pending.\n      window.addEventListener('beforeunload', this.boundCheckPendingActions);\n      // Switch between inline and sidebar annotations according to the window size.\n      window.addEventListener('resize', this.boundRefreshDisplayMode);\n      this.refreshDisplayMode();\n    }\n    resetLicenseKey() {\n      window.localStorage.removeItem(this.STORAGE_KEY);\n      window.location.reload();\n    }\n    checkPendingActions(domEvt) {\n      if (this.editor.plugins.get('PendingActions').hasAny) {\n        domEvt.preventDefault();\n        domEvt.returnValue = true;\n      }\n    }\n    showEditorDataInConsole(evt) {\n      const editorData = this.editor.data.get();\n      const trackChanges = this.editor.plugins.get('TrackChanges');\n      const comments = this.editor.plugins.get('CommentsRepository');\n      const suggestionsData = trackChanges.getSuggestions();\n      const commentThreadsData = comments.getCommentThreads({\n        skipNotAttached: true,\n        skipEmpty: true\n      });\n      console.log('Editor data:');\n      console.log(editorData);\n      console.log('Suggestions data:');\n      console.log(suggestionsData);\n      console.log('Comment threads data:');\n      console.log(commentThreadsData);\n      evt.preventDefault();\n    }\n    refreshDisplayMode() {\n      const annotationsUIs = this.editor.plugins.get('AnnotationsUIs');\n      const sidebarElement = this.sidebarContainer.nativeElement;\n      if (window.innerWidth < 1070) {\n        sidebarElement.classList.remove('narrow');\n        sidebarElement.classList.add('hidden');\n        annotationsUIs.switchTo('inline');\n      } else if (window.innerWidth < 1300) {\n        sidebarElement.classList.remove('hidden');\n        sidebarElement.classList.add('narrow');\n        annotationsUIs.switchTo('narrowSidebar');\n      } else {\n        sidebarElement.classList.remove('hidden', 'narrow');\n        annotationsUIs.switchTo('wideSidebar');\n      }\n    }\n    getInitialData() {\n      return `\n\t\t\t<h2>\n\t\t\t\tBilingual Personality Disorder\n\t\t\t</h2>\n\t\t\t<figure class=\"image image-style-side\">\n\t\t\t\t<img src=\"https://c.cksource.com/a/1/img/docs/sample-image-bilingual-personality-disorder.jpg\" srcset=\"https://c.cksource.com/a/1/img/docs/sample-image-bilingual-personality-disorder.jpg, https://c.cksource.com/a/1/img/docs/sample-image-bilingual-personality-disorder_2x.jpg 2x\">\n\t\t\t\t<figcaption>\n\t\t\t\t\tOne language, one person.\n\t\t\t\t</figcaption>\n\t\t\t</figure>\n\t\t\t<p>\n\t\t\t\tThis may be the first time you hear about this made-up disorder but it\n\t\t\t\t<suggestion-start name=\"insertion:suggestion-1:user-2\"></suggestion-start>actually<suggestion-end name=\"insertion:suggestion-1:user-2\"></suggestion-end>\n\t\t\t\tisn’t so far from the truth. Even the studies that were conducted almost half a century show\n\t\t\t\tthat <strong>the language you speak has more effects on you than you realize</strong>.\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\tOne of the very first experiments conducted on this topic dates back to 1964.\n\t\t\t\t<a href=\"https://www.researchgate.net/publication/9440038_Language_and_TAT_content_in_bilinguals\">In the experiment</a>\n\t\t\t\tdesigned by linguist Ervin-Tripp who is an\n\t\t\t\t<suggestion-start name=\"deletion:suggestion-2:user-1\"></suggestion-start>\n\t\t\t\tauthority<suggestion-end name=\"deletion:suggestion-2:user-1\">\n\t\t\t\t</suggestion-end>\n\t\t\t\t<suggestion-start name=\"insertion:suggestion-3:user-1\"></suggestion-start>\n\t\t\t\texpert<suggestion-end name=\"insertion:suggestion-3:user-1\"></suggestion-end>\n\t\t\t\tin psycholinguistic and sociolinguistic studies, adults who are bilingual\n\t\t\t\tin English in French were showed series of pictures and were asked to create 3-minute stories.\n\t\t\t\tIn the end participants emphasized\n\t\t\t\tdrastically different dynamics for stories in English and French.\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\tAnother ground-breaking experiment which included bilingual Japanese women married to American men\n\t\t\t\t<suggestion-start name=\"deletion:suggestion-4:user-1\"></suggestion-start>in San\n\t\t\t\tFrancisco <suggestion-end name=\"deletion:suggestion-4:user-1\">\n\t\t\t\t</suggestion-end>were\n\t\t\t\tasked to complete sentences. The goal of the experiment was to investigate whether or not human\n\t\t\t\tfeelings and thoughts\n\t\t\t\tare expressed differently in <strong>different language mindsets</strong>.\n\t\t\t</p>\n\t\t\t<p data-suggestion-start-before=\"formatBlock:698dn3otqzd6:suggestion-6:user-2\">\n\t\t\t\tHere is a sample from the the experiment:\n\t\t\t\t<suggestion-end name=\"formatBlock:698dn3otqzd6:suggestion-6:user-2\"></suggestion-end>\n\t\t\t</p>\n\t\t\t<table>\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th></th>\n\t\t\t\t\t\t<th>English</th>\n\t\t\t\t\t\t<th>Japanese</th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>Real friends should</td>\n\t\t\t\t\t\t<td>Be very frank</td>\n\t\t\t\t\t\t<td>Help each other</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>I will <suggestion-start name=\"formatInline:886cqig6g8rf:suggestion-5:user-2\"></suggestion-start>probably<suggestion-end name=\"formatInline:886cqig6g8rf:suggestion-5:user-2\" suggestion-type=\"formatInline:886cqig6g8rf\"></suggestion-end> become</td>\n\t\t\t\t\t\t<td>A teacher</td>\n\t\t\t\t\t<td>A housewife</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>When there is a conflict with family</td>\n\t\t\t\t\t\t<td>I do what I want</td>\n\t\t\t\t\t\t<td>It's a time of great unhappiness</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t\t<p>\n\t\t\t\tMore recent <a href=\"https://books.google.pl/books?id=1LMhWGHGkRUC\">studies</a> show, the\n\t\t\t\tlanguage a person speaks affects\n\t\t\t\ttheir cognition, behavior, emotions and hence <strong>their personality</strong>.\n\t\t\t\tThis shouldn’t come as a surprise\n\t\t\t\t<a href=\"https://en.wikipedia.org/wiki/Lateralization_of_brain_function\">since we already know</a>\n\t\t\t\tthat different regions of the brain become more active depending on the person’s activity at hand.\n\t\t\t\tThe structure, information and especially <strong>the culture</strong> of languages varies\n\t\t\t\tsubstantially and the language a person speaks is an essential element of daily life.\n\t\t\t</p>\n\t\t`;\n    }\n  }\n  LoadSaveIntegrationComponent.ɵfac = function LoadSaveIntegrationComponent_Factory(t) {\n    return new (t || LoadSaveIntegrationComponent)();\n  };\n  LoadSaveIntegrationComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LoadSaveIntegrationComponent,\n    selectors: [[\"load-save-integration\"]],\n    viewQuery: function LoadSaveIntegrationComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 7);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.sidebarContainer = _t.first);\n      }\n    },\n    outputs: {\n      ready: \"ready\"\n    },\n    decls: 43,\n    vars: 3,\n    consts: [[1, \"centered\"], [\"href\", \"https://ckeditor.com/ckeditor-5/\", \"target\", \"_blank\", \"rel\", \"noopener noreferrer\"], [\"src\", \"https://c.cksource.com/a/1/logos/ckeditor5.svg\", \"alt\", \"CKEditor 5 logo\"], [\"href\", \"https://ckeditor.com/collaboration/track-changes/\", \"target\", \"_blank\", \"rel\", \"noopener noreferrer\"], [\"href\", \"https://ckeditor.com/docs/ckeditor5/latest/features/collaboration/track-changes/track-changes.html\", \"target\", \"_blank\", \"rel\", \"noopener noreferrer\"], [1, \"message\"], [1, \"row\", \"row-editor\"], [3, \"editor\", \"config\", \"data\", \"ready\"], [1, \"sidebar\"], [\"sidebar\", \"\"], [1, \"row\", \"row-info\"], [1, \"get-data\", 3, \"click\"], [1, \"remove-license-key\", 3, \"click\"], [\"href\", \"https://cksource.com/\", \"target\", \"_blank\", \"rel\", \"noopener noreferrer\"]],\n    template: function LoadSaveIntegrationComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"header\")(1, \"div\", 0)(2, \"h1\")(3, \"a\", 1);\n        i0.ɵɵelement(4, \"img\", 2);\n        i0.ɵɵtext(5, \" CKEditor 5 \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"nav\")(7, \"ul\")(8, \"li\")(9, \"a\", 3);\n        i0.ɵɵtext(10, \"Website\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(11, \"li\")(12, \"a\", 4);\n        i0.ɵɵtext(13, \"Documentation\");\n        i0.ɵɵelementEnd()()()()()();\n        i0.ɵɵelementStart(14, \"main\")(15, \"div\", 5)(16, \"div\", 0)(17, \"h1\");\n        i0.ɵɵtext(18, \"CKEditor 5 track changes \\\"load and save\\\" integration for Angular\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(19, \"div\", 0)(20, \"div\", 6)(21, \"ckeditor\", 7);\n        i0.ɵɵlistener(\"ready\", function LoadSaveIntegrationComponent_Template_ckeditor_ready_21_listener($event) {\n          return ctx.onReady($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(22, \"div\", 8, 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"div\", 10);\n        i0.ɵɵtext(25, \" See the editor data in the console. \");\n        i0.ɵɵelementStart(26, \"button\", 11);\n        i0.ɵɵlistener(\"click\", function LoadSaveIntegrationComponent_Template_button_click_26_listener($event) {\n          return ctx.showEditorDataInConsole($event);\n        });\n        i0.ɵɵtext(27, \"Get editor data\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(28, \"div\", 10);\n        i0.ɵɵtext(29, \" Your license key is stored in the local storage. \");\n        i0.ɵɵelementStart(30, \"button\", 12);\n        i0.ɵɵlistener(\"click\", function LoadSaveIntegrationComponent_Template_button_click_30_listener() {\n          return ctx.resetLicenseKey();\n        });\n        i0.ɵɵtext(31, \"Reset license key\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(32, \"footer\")(33, \"div\", 0)(34, \"p\")(35, \"a\", 1);\n        i0.ɵɵtext(36, \"CKEditor 5\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(37, \" \\u2013 Rich text editor of tomorrow, available today \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"p\");\n        i0.ɵɵtext(39, \" Copyright \\u00A9 2003-2024, \");\n        i0.ɵɵelementStart(40, \"a\", 13);\n        i0.ɵɵtext(41, \"CKSource\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(42, \" Holding sp. z o.o. All rights reserved. \");\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(21);\n        i0.ɵɵproperty(\"editor\", ctx.Editor)(\"config\", ctx.editorConfig)(\"data\", ctx.data);\n      }\n    },\n    dependencies: [i1.CKEditorComponent]\n  });\n  return LoadSaveIntegrationComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}