{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { ElementRef, EventEmitter } from '@angular/core';\nimport * as ClassicEditorBuild from '../../../vendor/ckeditor5/build/classic-editor-with-real-time-collaboration.js';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ckeditor/ckeditor5-angular\";\nconst _c0 = [\"sidebar\"];\nconst _c1 = [\"presenceList\"];\nconst {\n  ClassicEditorWithRealTimeCollaboration,\n  CKBox\n} = ClassicEditorBuild;\nexport let EditorComponent = /*#__PURE__*/(() => {\n  class EditorComponent {\n    constructor() {\n      this.ready = new EventEmitter();\n      this.Editor = ClassicEditorWithRealTimeCollaboration;\n      this.data = this.getInitialData();\n      // Note that Angular refs can be used once the view is initialized so we need to create\n      // these containers and use in the above editor configuration to workaround this problem.\n      this.sidebar = document.createElement('div');\n      this.presenceList = document.createElement('div');\n      this.boundRefreshDisplayMode = this.refreshDisplayMode.bind(this);\n      this.boundCheckPendingActions = this.checkPendingActions.bind(this);\n    }\n    get editorConfig() {\n      return {\n        cloudServices: {\n          tokenUrl: this.configuration.tokenUrl,\n          webSocketUrl: this.configuration.webSocketUrl\n        },\n        collaboration: {\n          channelId: this.channelId\n        },\n        ckbox: {\n          tokenUrl: this.configuration.ckboxTokenUrl || this.configuration.tokenUrl\n        },\n        sidebar: {\n          container: this.sidebar\n        },\n        presenceList: {\n          container: this.presenceList\n        },\n        revisionHistory: {\n          editorContainer: document.querySelector('#editor-container'),\n          viewerContainer: document.querySelector('#revision-viewer-container'),\n          viewerEditorElement: document.querySelector('#revision-viewer-editor'),\n          viewerSidebarContainer: document.querySelector('#revision-viewer-sidebar')\n        },\n        autosave: {\n          save: editor => __awaiter(this, void 0, void 0, function* () {\n            const revisionTracker = editor.plugins.get('RevisionTracker');\n            const currentRevision = revisionTracker.currentRevision;\n            const oldRevisionVersion = currentRevision.toVersion;\n            // Update the current revision with the newest document changes.\n            yield revisionTracker.update();\n            // Check if the revision was updated.\n            // If not, do not make an unnecessary call.\n            if (oldRevisionVersion === currentRevision.toVersion) {\n              return true;\n            }\n            // Use the document data saved with the revision instead of the editor data.\n            // Revision data may slightly differ from the editor data when\n            // real-time collaboration is involved.\n            const documentData = yield revisionTracker.getRevisionDocumentData(revisionTracker.currentRevision);\n            // Use revision version instead of `cloudDocumentVersion`.\n            const documentVersion = currentRevision.toVersion;\n            console.log('Saving...');\n            console.log('Document data: ', documentData);\n            console.log('Document version: ', documentVersion);\n            // Asynchronous call which should save the document in your database.\n            return Promise.resolve();\n          }),\n          waitingTime: 3000\n        }\n      };\n    }\n    ngAfterViewInit() {\n      window.CKBox = CKBox;\n      if (!this.sidebarContainer || !this.presenceListContainer) {\n        throw new Error('Div containers for sidebar or presence list were not found');\n      }\n      this.sidebarContainer.nativeElement.appendChild(this.sidebar);\n      this.presenceListContainer.nativeElement.appendChild(this.presenceList);\n    }\n    ngOnDestroy() {\n      window.removeEventListener('resize', this.boundRefreshDisplayMode);\n      window.removeEventListener('beforeunload', this.boundCheckPendingActions);\n    }\n    onReady(editor) {\n      this.editor = editor;\n      this.ready.emit(editor);\n      // Prevent closing the tab when any action is pending.\n      window.addEventListener('beforeunload', this.boundCheckPendingActions);\n      // Switch between inline and sidebar annotations according to the window size.\n      window.addEventListener('resize', this.boundRefreshDisplayMode);\n      this.refreshDisplayMode();\n    }\n    checkPendingActions(domEvt) {\n      if (this.editor.plugins.get('PendingActions').hasAny) {\n        domEvt.preventDefault();\n        domEvt.returnValue = true;\n      }\n    }\n    refreshDisplayMode() {\n      const annotationsUIs = this.editor.plugins.get('AnnotationsUIs');\n      const sidebarElement = this.sidebarContainer.nativeElement;\n      if (window.innerWidth < 1070) {\n        sidebarElement.classList.remove('narrow');\n        sidebarElement.classList.add('hidden');\n        annotationsUIs.switchTo('inline');\n      } else if (window.innerWidth < 1300) {\n        sidebarElement.classList.remove('hidden');\n        sidebarElement.classList.add('narrow');\n        annotationsUIs.switchTo('narrowSidebar');\n      } else {\n        sidebarElement.classList.remove('hidden', 'narrow');\n        annotationsUIs.switchTo('wideSidebar');\n      }\n    }\n    getInitialData() {\n      return `\n\t<h2>Bilingual Personality Disorder</h2>\n\n\t<figure class=\"image image-style-side\">\n\t\t<img src=\"https://c.cksource.com/a/1/img/docs/sample-image-bilingual-personality-disorder.jpg\" srcset=\"https://c.cksource.com/a/1/img/docs/sample-image-bilingual-personality-disorder.jpg, https://c.cksource.com/a/1/img/docs/sample-image-bilingual-personality-disorder_2x.jpg 2x\">\n\t\t<figcaption>\n\t\t\tOne language, one person.\n\t\t</figcaption>\n\t</figure>\n\n\t<p>\n\t\tThis may be the first time you hear about this made-up disorder but it actually isn’t so far from the truth. Even the studies\n\t\tthat were conducted almost half a century show that <strong>the language you speak has more effects on you than you realize</strong>.\n\t</p>\n\t<p>\n\t\tOne of the very first experiments conducted on this topic dates back to 1964.\n\t\t<a href=\"https://www.researchgate.net/publication/9440038_Language_and_TAT_content_in_bilinguals\">In the experiment</a>\n\t\tdesigned by linguist Ervin-Tripp who is an expert in psycholinguistic and sociolinguistic studies, adults who are bilingual\n\t\tin English in French were showed series of pictures and were asked to create 3-minute stories. In the end participants emphasized\n\t\tdrastically different dynamics for stories in English and French.\n\t</p>\n\t<p>\n\t\tAnother ground-breaking experiment which included bilingual Japanese women married to American men in San Francisco were asked\n\t\tto complete sentences. The goal of the experiment was to investigate whether or not human feelings and thoughts are expressed\n\t\tdifferently in <strong>different language mindsets</strong>.\n\t</p>\n\t<p>Here is a sample from the the experiment:</p>\n\n\t<table>\n\t\t<thead>\n\t\t\t<tr>\n\t\t\t\t<th></th>\n\t\t\t\t<th>English</th>\n\t\t\t\t<th>Japanese</th>\n\t\t\t</tr>\n\t\t</thead>\n\t\t<tbody>\n\t\t\t<tr>\n\t\t\t\t<td>Real friends should</td>\n\t\t\t\t<td>Be very frank</td>\n\t\t\t\t<td>Help each other</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td>I will probably become</td>\n\t\t\t\t<td>A teacher</td>\n\t\t\t\t<td>A housewife</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td>When there is a conflict with family</td>\n\t\t\t\t<td>I do what I want</td>\n\t\t\t\t<td>It's a time of great unhappiness</td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n\n\t<p>\n\t\tMore recent <a href=\"https://books.google.pl/books?id=1LMhWGHGkRUC\">studies</a> show, the language a person speaks affects\n\t\ttheir cognition, behavior, emotions and hence <strong>their personality</strong>. This shouldn’t come as a surprise\n\t\t<a href=\"https://en.wikipedia.org/wiki/Lateralization_of_brain_function\">since wealready know</a> that different regions\n\t\tof the brain become more active depending on the person’s activity at hand. The structure, information and especially\n\t\t<strong>the culture</strong> of languages varies substantially and the language a person speaks is an essential element of daily life.\n\t</p>\n`;\n    }\n  }\n  EditorComponent.ɵfac = function EditorComponent_Factory(t) {\n    return new (t || EditorComponent)();\n  };\n  EditorComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: EditorComponent,\n    selectors: [[\"app-editor\"]],\n    viewQuery: function EditorComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 7);\n        i0.ɵɵviewQuery(_c1, 7);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.sidebarContainer = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.presenceListContainer = _t.first);\n      }\n    },\n    inputs: {\n      configuration: \"configuration\",\n      channelId: \"channelId\"\n    },\n    outputs: {\n      ready: \"ready\"\n    },\n    decls: 46,\n    vars: 3,\n    consts: [[1, \"centered\"], [\"href\", \"https://ckeditor.com/ckeditor-5/\", \"target\", \"_blank\", \"rel\", \"noopener noreferrer\"], [\"src\", \"https://c.cksource.com/a/1/logos/ckeditor5.svg\", \"alt\", \"CKEditor 5 logo\"], [\"href\", \"https://ckeditor.com/collaboration/\", \"target\", \"_blank\", \"rel\", \"noopener noreferrer\"], [\"href\", \"https://ckeditor.com/docs/ckeditor5/latest/features/collaboration/real-time-collaboration/real-time-collaboration.html\", \"target\", \"_blank\", \"rel\", \"noopener noreferrer\"], [1, \"message\"], [1, \"row\", \"row-presence\"], [1, \"presence\"], [\"presenceList\", \"\"], [1, \"row\", \"row-editor\"], [1, \"editors-holder\"], [\"id\", \"editor-container\", 1, \"editor-container\"], [1, \"editor-container\", 3, \"editor\", \"config\", \"data\", \"ready\"], [\"id\", \"sidebar-container\", 1, \"sidebar\", \"sidebar-container\"], [\"sidebar\", \"\"], [\"id\", \"revision-viewer-container\"], [1, \"editor-container\"], [\"id\", \"revision-viewer-editor\"], [\"id\", \"revision-viewer-sidebar\", 1, \"sidebar-container\"], [\"href\", \"https://cksource.com/\", \"target\", \"_blank\", \"rel\", \"noopener noreferrer\"]],\n    template: function EditorComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"header\")(1, \"div\", 0)(2, \"h1\")(3, \"a\", 1);\n        i0.ɵɵelement(4, \"img\", 2);\n        i0.ɵɵtext(5, \" CKEditor 5 \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"nav\")(7, \"ul\")(8, \"li\")(9, \"a\", 3);\n        i0.ɵɵtext(10, \"Website\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(11, \"li\")(12, \"a\", 4);\n        i0.ɵɵtext(13, \"Documentation\");\n        i0.ɵɵelementEnd()()()()()();\n        i0.ɵɵelementStart(14, \"main\")(15, \"div\", 5)(16, \"div\", 0)(17, \"h2\");\n        i0.ɵɵtext(18, \"CKEditor 5 Angular integration of classic editor with real-time collaboration and revision history\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"p\");\n        i0.ɵɵtext(20, \" Open this sample in another browser tab to start real-time collaborative editing. \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(21, \"div\", 0)(22, \"div\", 6);\n        i0.ɵɵelement(23, \"div\", 7, 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"div\", 9)(26, \"div\", 10)(27, \"div\", 11)(28, \"ckeditor\", 12);\n        i0.ɵɵlistener(\"ready\", function EditorComponent_Template_ckeditor_ready_28_listener($event) {\n          return ctx.onReady($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(29, \"div\", 13, 14);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"div\", 15)(32, \"div\", 16);\n        i0.ɵɵelement(33, \"div\", 17)(34, \"div\", 18);\n        i0.ɵɵelementEnd()()()()()();\n        i0.ɵɵelementStart(35, \"footer\")(36, \"div\", 0)(37, \"p\")(38, \"a\", 1);\n        i0.ɵɵtext(39, \"CKEditor 5\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(40, \" \\u2013 Rich text editor of tomorrow, available today \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(41, \"p\");\n        i0.ɵɵtext(42, \" Copyright \\u00A9 2003-2024, \");\n        i0.ɵɵelementStart(43, \"a\", 19);\n        i0.ɵɵtext(44, \"CKSource\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(45, \" Holding sp. z o.o. All rights reserved. \");\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(28);\n        i0.ɵɵproperty(\"editor\", ctx.Editor)(\"config\", ctx.editorConfig)(\"data\", ctx.data);\n      }\n    },\n    dependencies: [i1.CKEditorComponent]\n  });\n  return EditorComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}