{"ast":null,"code":"import { NgForm } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"./editor/editor.component\";\nimport * as i3 from \"@angular/forms\";\nconst _c0 = [\"form\"];\nfunction AppComponent_div_0_div_23_img_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 23);\n  }\n  if (rf & 2) {\n    const data_r4 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵpropertyInterpolate(\"src\", data_r4.avatar, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction AppComponent_div_0_div_23_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 24);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const data_r4 = i0.ɵɵnextContext().$implicit;\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r6.getUserInitials(data_r4.name));\n  }\n}\nfunction AppComponent_div_0_div_23_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"span\", 25);\n  }\n}\nfunction AppComponent_div_0_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_0_div_23_Template_div_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const data_r4 = restoredCtx.$implicit;\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r10.selectUser(data_r4));\n    });\n    i0.ɵɵtemplate(1, AppComponent_div_0_div_23_img_1_Template, 1, 1, \"img\", 19);\n    i0.ɵɵtemplate(2, AppComponent_div_0_div_23_span_2_Template, 2, 1, \"span\", 20);\n    i0.ɵɵtemplate(3, AppComponent_div_0_div_23_span_3_Template, 1, 0, \"span\", 21);\n    i0.ɵɵelementStart(4, \"span\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"span\", 22);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const data_r4 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassMap(ctx_r3.selectedUser == data_r4.id ? \"active\" : \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", data_r4.avatar);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !data_r4.avatar && data_r4.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !data_r4.avatar && !data_r4.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(data_r4.name || \"(anonymous)\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(data_r4.role);\n  }\n}\nfunction AppComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 2)(2, \"form\", 3, 4);\n    i0.ɵɵlistener(\"ngSubmit\", function AppComponent_div_0_Template_form_ngSubmit_2_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.handleSubmit());\n    });\n    i0.ɵɵelementStart(4, \"h2\");\n    i0.ɵɵtext(5, \"Connect CKEditor Cloud Services\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7, \" If you do not have Cloud Services URLs yet,\\u00A0 \");\n    i0.ɵɵelementStart(8, \"a\", 5);\n    i0.ɵɵtext(9, \" see the documentation \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \". \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"div\")(12, \"label\", 6);\n    i0.ɵɵtext(13, \"WebSocket URL\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"input\", 7);\n    i0.ɵɵlistener(\"ngModelChange\", function AppComponent_div_0_Template_input_ngModelChange_14_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.config.webSocketUrl = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"div\")(16, \"label\", 8);\n    i0.ɵɵtext(17, \"Token URL\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"input\", 9);\n    i0.ɵɵlistener(\"ngModelChange\", function AppComponent_div_0_Template_input_ngModelChange_18_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.config.tokenUrl = $event);\n    })(\"input\", function AppComponent_div_0_Template_input_input_18_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.handleTokenUrlChange());\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(19, \"div\", 10)(20, \"p\");\n    i0.ɵɵtext(21, \"Use one of the following users to define the user data.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"div\", 11);\n    i0.ɵɵtemplate(23, AppComponent_div_0_div_23_Template, 8, 8, \"div\", 12);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(24, \"div\")(25, \"label\", 13);\n    i0.ɵɵtext(26, \"CKBox token URL (optional)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(27, \"input\", 14);\n    i0.ɵɵlistener(\"ngModelChange\", function AppComponent_div_0_Template_input_ngModelChange_27_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.config.ckboxTokenUrl = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(28, \"div\")(29, \"label\", 15);\n    i0.ɵɵtext(30, \"Channel ID\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(31, \"input\", 16);\n    i0.ɵɵlistener(\"ngModelChange\", function AppComponent_div_0_Template_input_ngModelChange_31_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.channelId = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(32, \"button\", 17);\n    i0.ɵɵtext(33, \"Start\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const _r2 = i0.ɵɵreference(3);\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassProp(\"warning\", ctx_r0.isWarning);\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.config.webSocketUrl);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.config.tokenUrl);\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassProp(\"visible\", ctx_r0.isCloudServicesTokenEndpoint());\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.users);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.config.ckboxTokenUrl);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.channelId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", !_r2.valid);\n  }\n}\nfunction AppComponent_app_editor_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-editor\", 26);\n    i0.ɵɵlistener(\"ready\", function AppComponent_app_editor_1_Template_app_editor_ready_0_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r19 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r19.onEditorReady($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"configuration\", ctx_r1.config)(\"channelId\", ctx_r1.channelId);\n  }\n}\nconst LOCAL_STORAGE_KEY = 'CKEDITOR_CS_CONFIG';\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor() {\n      this.configurationSet = false;\n      this.users = getUsers();\n      this.channelId = handleChannelIdInUrl();\n      this.config = getStoredConfig();\n      this.isWarning = false;\n    }\n    handleSubmit() {\n      if (!this.form || !this.form.valid) {\n        return;\n      }\n      if (this.isCloudServicesTokenEndpoint() && !this.config.tokenUrl.includes('?')) {\n        this.isWarning = true;\n        return;\n      }\n      storeConfig({\n        tokenUrl: getRawTokenUrl(this.config.tokenUrl),\n        ckboxTokenUrl: this.config.ckboxTokenUrl,\n        webSocketUrl: this.config.webSocketUrl\n      });\n      updateChannelIdInUrl(this.channelId);\n      this.configurationSet = true;\n    }\n    handleTokenUrlChange() {\n      this.isWarning = false;\n      this.selectedUser = undefined;\n    }\n    selectUser(user) {\n      this.selectedUser = user.id;\n      this.isWarning = false;\n      const keys = Object.keys(user);\n      this.config.tokenUrl = `${getRawTokenUrl(this.config.tokenUrl)}?` + keys.filter(key => user[key]).map(key => {\n        if (key === 'role') {\n          return `${key}=${user[key]}`;\n        }\n        return `user.${key}=${user[key]}`;\n      }).join('&');\n    }\n    isCloudServicesTokenEndpoint() {\n      return isCloudServicesTokenEndpoint(this.config.tokenUrl);\n    }\n    getUserInitials(name) {\n      return name.split(' ', 2).map(part => part.charAt(0)).join('').toUpperCase();\n    }\n    onEditorReady(editor) {\n      console.log('Editor is ready to use!', editor);\n    }\n  }\n  AppComponent.ɵfac = function AppComponent_Factory(t) {\n    return new (t || AppComponent)();\n  };\n  AppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponent,\n    selectors: [[\"app-root\"]],\n    viewQuery: function AppComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.form = _t.first);\n      }\n    },\n    decls: 2,\n    vars: 2,\n    consts: [[4, \"ngIf\"], [3, \"configuration\", \"channelId\", \"ready\", 4, \"ngIf\"], [\"id\", \"overlay\"], [1, \"body\", 3, \"ngSubmit\"], [\"form\", \"ngForm\"], [\"href\", \"https://ckeditor.com/docs/cs/latest/guides/collaboration/quick-start.html\", \"target\", \"_blank\", \"rel\", \"noopener noreferrer\"], [\"for\", \"web-socket-url\"], [\"id\", \"web-socket-url\", \"name\", \"web-socket-url\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"token-url\"], [\"id\", \"token-url\", \"name\", \"token-url\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\", \"input\"], [\"id\", \"additional\"], [\"id\", \"user-container\"], [3, \"class\", \"click\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"ckbox-token-url\"], [\"id\", \"ckbox-token-url\", \"name\", \"ckbox-token-url\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"channel-id\"], [\"id\", \"channel-id\", \"name\", \"channel-id\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"id\", \"start\", 3, \"disabled\"], [3, \"click\"], [3, \"src\", 4, \"ngIf\"], [\"class\", \"pseudo-avatar\", 4, \"ngIf\"], [\"class\", \"pseudo-avatar anonymous\", 4, \"ngIf\"], [1, \"role\"], [3, \"src\"], [1, \"pseudo-avatar\"], [1, \"pseudo-avatar\", \"anonymous\"], [3, \"configuration\", \"channelId\", \"ready\"]],\n    template: function AppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, AppComponent_div_0_Template, 34, 10, \"div\", 0);\n        i0.ɵɵtemplate(1, AppComponent_app_editor_1_Template, 1, 2, \"app-editor\", 1);\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", !ctx.configurationSet);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.configurationSet);\n      }\n    },\n    dependencies: [i1.NgForOf, i1.NgIf, i2.EditorComponent, i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.RequiredValidator, i3.NgModel, i3.NgForm],\n    styles: [\"*[_ngcontent-%COMP%]{box-sizing:border-box}body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{margin:0}#overlay[_ngcontent-%COMP%]{font-family:Helvetica;width:100%;height:100%;position:fixed;top:0;bottom:0;left:0;background:#333;display:flex;flex-direction:column;align-items:center;padding:4vh 4vw;overflow:auto}#overlay.hidden[_ngcontent-%COMP%]{display:none}#overlay[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{font-size:14px;width:100%;max-width:800px;background:white;padding:40px;border-radius:3px;box-shadow:0 0 15px 5px #000}#overlay[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;text-align:center}#overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5em;width:100%}#overlay[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#0059ff;text-decoration:none}#overlay[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}#overlay[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;align-items:center;margin:15px 0}#overlay[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:180px;font-weight:700}#overlay[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:8px;font-size:1em;border:1px solid gray;transition:border .2s}#overlay[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border:1px solid #ff0000;outline-color:red}button#start[_ngcontent-%COMP%]{display:block;width:100%;max-width:300px;margin:20px auto 0;padding:15px;background:hsl(104,44%,48%);color:#fff;font-weight:700;border:0;border-radius:3px;font-size:1em;cursor:pointer;transition:.25s ease background}button#start[_ngcontent-%COMP%]:hover{background:hsl(104,44%,41%)}button#start[_ngcontent-%COMP%]:disabled{background:lightgray;cursor:auto}#overlay[_ngcontent-%COMP%]   #additional[_ngcontent-%COMP%]{display:none;flex-wrap:wrap}#overlay[_ngcontent-%COMP%]   #additional.visible[_ngcontent-%COMP%]{display:flex}#overlay.warning[_ngcontent-%COMP%]   #additional[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{color:red}#overlay.warning[_ngcontent-%COMP%]   #user-container[_ngcontent-%COMP%]{border-color:red}#overlay[_ngcontent-%COMP%]   #user-container[_ngcontent-%COMP%]{width:100%;border:1px solid hsl(0,0%,85%)}#overlay[_ngcontent-%COMP%]   #user-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;cursor:pointer;align-items:center;height:48px;padding:10px;background:hsl(0,0%,97%);transition:.25s ease background}#overlay[_ngcontent-%COMP%]   #user-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(odd){background:#fff}#overlay[_ngcontent-%COMP%]   #user-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover{background:hsl(0,0%,92%)}#overlay[_ngcontent-%COMP%]   #user-container[_ngcontent-%COMP%]   div.active[_ngcontent-%COMP%]{background:hsl(133,50%,84%)}#overlay[_ngcontent-%COMP%]   #user-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], #overlay[_ngcontent-%COMP%]   #user-container[_ngcontent-%COMP%]   .pseudo-avatar[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;border:2px solid var(--ck-user-avatar-background);margin-right:10px;background:var(--ck-user-avatar-color)}#overlay[_ngcontent-%COMP%]   #user-container[_ngcontent-%COMP%]   .pseudo-avatar[_ngcontent-%COMP%]{font-size:.9em;text-align:center;line-height:30px;background:var(--ck-user-avatar-background);color:var(--ck-user-avatar-color)}#overlay[_ngcontent-%COMP%]   #user-container[_ngcontent-%COMP%]   .pseudo-avatar.anonymous[_ngcontent-%COMP%]{background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2020%2020%22%3E%0A%20%20%3Cpath%20fill%3D%22%23FFF%22%20fill-rule%3D%22nonzero%22%20d%3D%22M9.8%2020H2c0-5.7%205-5.7%206-7l.2-.8c-1.6-.8-2.7-2.7-2.7-5%200-2.8%202-5.2%204.3-5.2S14%204.4%2014%207.3c0%202.2-1%204-2.6%205l.2.6c1.2%201.3%206%201.4%206%207H9.8z%22%2F%3E%0A%3C%2Fsvg%3E)}.role[_ngcontent-%COMP%]{font-size:11px;border:1px solid #3570aa;border-radius:4px;color:#3570aa;padding:2px 5px;margin-left:10px;font-weight:700;margin-top:2px}\"]\n  });\n  return AppComponent;\n})();\nfunction getUsers() {\n  return [{\n    id: 'e1',\n    name: 'Tom Rowling',\n    avatar: 'https://randomuser.me/api/portraits/men/30.jpg',\n    role: 'writer'\n  }, {\n    id: 'e2',\n    name: 'Wei Hong',\n    avatar: 'https://randomuser.me/api/portraits/women/51.jpg',\n    role: 'writer'\n  }, {\n    id: 'e3',\n    name: 'Rani Patel',\n    role: 'writer'\n  }, {\n    id: 'e4',\n    name: 'Henrik Jensen',\n    role: 'commentator'\n  }, {\n    id: randomString(),\n    role: 'writer'\n  }, {\n    id: randomString(),\n    role: 'reader'\n  }];\n}\nfunction handleChannelIdInUrl() {\n  let id = getChannelIdFromUrl();\n  if (!id) {\n    id = randomString();\n    updateChannelIdInUrl(id);\n  }\n  return id;\n}\nfunction getChannelIdFromUrl() {\n  const channelIdMatch = location.search.match(/channelId=(.+)$/);\n  return channelIdMatch ? decodeURIComponent(channelIdMatch[1]) : null;\n}\nfunction randomString() {\n  return Math.floor(Math.random() * Math.pow(2, 52)).toString(32);\n}\nfunction storeConfig(csConfig) {\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(csConfig));\n}\nfunction updateChannelIdInUrl(id) {\n  window.history.replaceState({}, document.title, generateUrlWithChannelId(id));\n}\nfunction generateUrlWithChannelId(id) {\n  return `${window.location.href.split('?')[0]}?channelId=${id}`;\n}\nfunction getRawTokenUrl(url) {\n  if (isCloudServicesTokenEndpoint(url)) {\n    return url.split('?')[0];\n  }\n  return url;\n}\nfunction isCloudServicesTokenEndpoint(tokenUrl) {\n  return /cke-cs[\\w-]*\\.com\\/token\\/dev/.test(tokenUrl);\n}\nfunction getStoredConfig() {\n  const config = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY) || '{}');\n  return {\n    tokenUrl: config.tokenUrl || '',\n    ckboxTokenUrl: config.ckboxTokenUrl || '',\n    webSocketUrl: config.webSocketUrl || ''\n  };\n}","map":null,"metadata":{},"sourceType":"module"}